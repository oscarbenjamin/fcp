<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>EMAT10006 - Further Computer Programming - </title>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="style.css" type="text/css" />
  <script src="https://d3eoax9i5htok0.cloudfront.net/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <script type="text/javascript" async
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>
</head>
  <body>
    <div id="header">
        EMAT10006 - Further Computer Programming
    </div>
    <div id="TOC">
      <ul><li><a href="index.html">Site Index</a></li></ul>
<ul>
<li><a href="#strings-in-c">Strings in C</a><ul>
<li><a href="#string-functions">String functions</a></li>
<li><a href="#exercise---print-the-ascii-characters">Exercise - print the ascii characters</a></li>
<li><a href="#exercise---upper-and-lower-case">Exercise - upper and lower case</a></li>
<li><a href="#exercise---digits">Exercise - digits</a></li>
<li><a href="#parsing-strings">Parsing strings</a></li>
<li><a href="#exercise---sscanf">Exercise - sscanf</a></li>
<li><a href="#command-line-arguments">Command line arguments</a></li>
<li><a href="#exercise">Exercise</a></li>
</ul></li>
</ul>
    </div>
    <div id="main">
<h1 id="strings-in-c"><a href="#TOC">Strings in C</a></h1>
<p>We've been using strings for a while now but one thing that we've overlooked is how they actually work in C. In Python it's not necessary to know how the work but in C it is. So here it is: in C a string is an array of type <code>char</code>. Everything that I've said about arrays also applies to strings. Here's how to rewrite our original hello world program so that it uses a string variable instead of just a literal:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="co">/* hello.c */</span>

<span class="ot">#include &lt;stdio.h&gt;</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
  <span class="dt">char</span> message[] = <span class="st">&quot;Hello world!&quot;</span>;

  puts(message);

  <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre>
<p>This gives the same output as before:</p>
<pre><code>$ make
gcc -std=c99 -Wall hello.c -o hello.exe
$ ./hello_variable.exe
Hello world!</code></pre>
<p>So we see that in the same way that a decimal literal e.g. <code>123</code> represents an object of type <code>int</code> a string literal e.g. <code>&quot;Hello&quot;</code> represents an object of type <code>char[]</code>. A string is an array of type <code>char</code>.</p>
<p>We saw before that <code>char</code> is a signed integer type so what does it mean that a string is an array of type <code>char</code>? The most commonly used characters are given integer numbers from 1 to 127 and these are used to represent each character. We can also initialise a string using the array initialiser syntax that we have already seen. These three are quivalent:</p>
<pre class="sourceCode C"><code class="sourceCode c">  <span class="dt">char</span> message1[] = {<span class="dv">72</span>, <span class="dv">101</span>, <span class="dv">108</span>, <span class="dv">108</span>, <span class="dv">111</span>, <span class="dv">32</span>,
                <span class="dv">87</span>, <span class="dv">111</span>, <span class="dv">114</span>, <span class="dv">108</span>, <span class="dv">100</span>, <span class="dv">33</span>, <span class="dv">10</span>,
                <span class="dv">0</span>};

  <span class="dt">char</span> message2[] = {&#39;H&#39;, &#39;e&#39;, &#39;l&#39;, &#39;l&#39;, &#39;o&#39;, &#39; &#39;,
                &#39;W&#39;, &#39;o&#39;, &#39;r&#39;, &#39;l&#39;, &#39;d&#39;, &#39;!&#39;, <span class="ch">&#39;\n&#39;</span>,
                &#39;\<span class="dv">0</span>&#39;};

  <span class="dt">char</span> message3[] = <span class="st">&quot;Hello World!</span><span class="ch">\n</span><span class="st">&quot;</span>;</code></pre>
<p>Notice that we need to put an extra <code>'\0'</code> character at the end of the array. This is called the null zero (or null byte) and is added implicitly when we write a string literal with double quotes <code>&quot;&quot;</code>. The <code>'\0'</code> character has integer value <code>0</code> and is used to mark the end of the string. I said before that in C when we pass an array into a function then the function cannot know the size of the array. That's why we would normally give each function that takes an array an additional argument to tell it the size of an array. We don't need to do that with strings because they are <em>null-terminated</em>.</p>
<p>For example the <code>puts</code> function above will know that the end of the string occurs when it finds the <code>'\0'</code> character. There is another function called <code>putc</code> (short for put Character) which prints an individual character. The <code>puts</code> function essentially works like this:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="dt">int</span> puts(<span class="dt">char</span> string[])
{
  <span class="dt">int</span> i = <span class="dv">0</span>;

  <span class="co">// Loop until we hit the null zero</span>
  <span class="kw">while</span>(string[i] != &#39;\<span class="dv">0</span>&#39;)
  {
    <span class="co">// Print current character</span>
    fputc(string[i], stdout);
    i++;
  }
  <span class="kw">return</span> <span class="dv">1</span>; <span class="co">// indicate success</span>
}</code></pre>
<p>Actually if an error occurs while printing then the <code>puts</code> function may return something other than 1 and it's more complicated than this but the basic idea is that it finds the end of the string by looking for the null byte.</p>
<p>If we declare the size of a string then we need to add 1 to account for this null byte. If a string has <code>n</code> characters then it needs <code>n+1</code> bytes of memory.</p>
<pre class="sourceCode C"><code class="sourceCode c">  <span class="dt">char</span> message[<span class="dv">6</span>] = <span class="st">&quot;hello&quot;</span>;</code></pre>
<p>However we don't normally need to explcitly declare the size since the compiler can do that for us.</p>
<h2 id="string-functions"><a href="#TOC">String functions</a></h2>
<p>There are a number of functions provided in the <code>string.h</code> header that are useful for working with strings.</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="co">/* string.c */</span>

<span class="ot">#include &lt;stdio.h&gt;</span>
<span class="ot">#include &lt;string.h&gt; // &lt;-- string functions</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
  <span class="dt">char</span> message[] = <span class="st">&quot;Hello world!&quot;</span>;

  <span class="co">// strlen finds the length of a string</span>
  <span class="dt">int</span> length = strlen(message);

  printf(<span class="st">&quot;The string is </span><span class="ch">\&quot;</span><span class="st">%s</span><span class="ch">\&quot;\n</span><span class="st">&quot;</span>, message);
  printf(<span class="st">&quot;It has %d characters</span><span class="ch">\n</span><span class="st">&quot;</span>, length);
  printf(<span class="st">&quot;It needs %d bytes</span><span class="ch">\n</span><span class="st">&quot;</span>, length + <span class="dv">1</span>);

  <span class="dt">char</span> name1[] = <span class="st">&quot;dave&quot;</span>;
  <span class="dt">char</span> name2[] = <span class="st">&quot;john&quot;</span>;

  <span class="co">// Compare the two strings</span>
  <span class="dt">int</span> compare = strcmp(name1, name2);

  <span class="kw">if</span>(compare == <span class="dv">0</span>)
  {
    printf(<span class="st">&quot;The strings are equal</span><span class="ch">\n</span><span class="st">&quot;</span>);
  }
  <span class="kw">else</span> <span class="co">// compare != 0</span>
  {
    printf(<span class="st">&quot;The strings are not equal</span><span class="ch">\n</span><span class="st">&quot;</span>);
  }

  <span class="co">// Shorthand - notice the ! below</span>
  <span class="kw">if</span>(!strcmp(name1, name2))
  {
    printf(<span class="st">&quot;The strings are equal</span><span class="ch">\n</span><span class="st">&quot;</span>);
  }
  <span class="kw">else</span>
  {
    printf(<span class="st">&quot;The strings are not equal</span><span class="ch">\n</span><span class="st">&quot;</span>);
  }

  <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre>
<p>The above program demonstrates the two most commonly used string functions in C. <code>strlen</code> returns the number of characters in a string. Note that this is one less than the number of bytes of memory used by the string because we also need a byte for the null zero.</p>
<p><code>strcmp</code> is used to compare two strings (writing <code>a == b</code> does NOT work). The return value from <code>strcmp</code> is zero if the two strings are equal and non-zero otherwise. This means that if we want to test if two strings are equal we usually write <code>if(!strcmp(str1, str2))</code> where the <code>!</code> symbol is the logical not operator.</p>
<h2 id="exercise---print-the-ascii-characters"><a href="#TOC">Exercise - print the ascii characters</a></h2>
<p>We can print an ASCII number and corresponding character with something like</p>
<pre class="sourceCode C"><code class="sourceCode c">    printf(<span class="st">&quot;ASCII num: %d  character &#39;%c&#39;&quot;</span>, <span class="dv">65</span>, <span class="dv">65</span>);</code></pre>
<p>Make a program that prints all the ASCII characters from 1 to 127. Take a careful look at the output.</p>
<h2 id="exercise---upper-and-lower-case"><a href="#TOC">Exercise - upper and lower case</a></h2>
<p>There is a function called <code>isupper</code> declared in the <code>ctype.h</code> header which you can use:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="ot">#include &lt;ctype.h&gt; // &lt;-- for isupper</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
    <span class="dt">char</span> string = <span class="st">&quot;Hello&quot;</span>;

    <span class="kw">if</span>(isupper(string[<span class="dv">0</span>]))
    {
      <span class="co">// First character is upper case A-Z</span>
    }
    <span class="kw">else</span>
    {
      <span class="co">// First character is something else.</span>
    }
    <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre>
<p>The <code>ctype.h</code> header defines a bunch of functions. <code>isupper</code> determines if a character is upper case and returns non-zero if it is. <code>islower</code> determines if it is lower case (these are not mutually exclusive!). We also have <code>tolower</code> which takes a character and returns the same character unless it is an upper case character. If it is an upper case character it will return the lower case equivalent. Study these functions by testing different values e.g.: <code>tolower('a')</code> and <code>tolower('A')</code> or <code>tolower('$')</code>, <code>isupper('+')</code> etc. Make sure you understand what they do and then try to write your own version of each of these functions using the ASCII numbers for the different characters.</p>
<p>To work with ASCII codes remember that it's just integer arithmetic. A character with ASCII number \(n\) is upper case if \(65 \le n \le 90\). In C we can spell that as <code>'A' &lt;= n &amp;&amp; n &lt;= 'Z'</code> since <code>'A'</code> is equivalent to <code>65</code>. Similarly all the lower case characters are 32 greater than their upper case equivalents so e.g. <code>'a' == 'A' + 32</code>. We could convert <code>c</code> to lower case with something like this <code>c + ('a' - 'A')</code> This gives us an easy arithmetic way to convert a character from lower to upper case or vice-versa.</p>
<h2 id="exercise---digits"><a href="#TOC">Exercise - digits</a></h2>
<p>Often we have strings representing numbers e.g. &quot;123&quot;. Note that the ASCII number for the character &quot;1&quot; is <em>not</em> 1. Make two functions <code>is_digit</code> and <code>to_int</code> that can check if a character is a digit character (0-9) and convert it to its integer value. We should be able to use these functions in a programme like this:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="co">/* digits.c */</span>

<span class="ot">#include &lt;stdio.h&gt;</span>
<span class="ot">#include &lt;string.h&gt;</span>

<span class="dt">int</span> is_digit(<span class="dt">char</span> c);
<span class="dt">int</span> to_int(<span class="dt">char</span> c);

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
  <span class="dt">char</span> string[] = <span class="st">&quot;I saw 123 things&quot;</span>;

  <span class="dt">int</span> length = strlen(string);
  <span class="dt">int</span> total = <span class="dv">0</span>;

  <span class="kw">for</span>(<span class="dt">int</span> i=<span class="dv">0</span>; i&lt;length; i++)
  {
    <span class="kw">if</span>(is_digit(string[i]))
    {
      total += to_int(string[i]);
    }
  }

  printf(<span class="st">&quot;The sum of the digits is %d</span><span class="ch">\n</span><span class="st">&quot;</span>, total);

  <span class="kw">return</span> <span class="dv">0</span>;
}

<span class="co">// Insert function definitions here:</span></code></pre>
<p>The output from the program should be:</p>
<pre><code>$ make
gcc -std=c99 -Wall digits.c -o digits.exe
$ ./digits.exe
sum of digits in &quot;I saw 123 things&quot; is 6</code></pre>
<p>Note that in practice (when not doing this exercise) you should use the functions such as <code>isdigit</code> which are already provided for you rather than writing your own.</p>
<h2 id="parsing-strings"><a href="#TOC">Parsing strings</a></h2>
<p>Parsing a string means processing it to extract data. Parsing is a very common part of normal programming. We might do this because we have a string e.g. <code>&quot;123&quot;</code> and we want to multiply it by 2. We can't multiply strings so we first convert it to the integer value <code>123</code> and then multiply that by 2.</p>
<p>The standard way to parse strings in C is to use the <code>sscanf</code> function. This works a bit like <code>printf</code> but in reverse:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="co">/* parse.c */</span>

<span class="ot">#include &lt;stdio.h&gt;</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
  <span class="dt">char</span> string[] = <span class="st">&quot;123&quot;</span>;

  <span class="dt">int</span> number;
  <span class="kw">if</span>(!sscanf(string, <span class="st">&quot;%d&quot;</span>, &amp;number))
  {
    fprintf(stderr, <span class="st">&quot;Could not parse the string...&quot;</span>);
    <span class="kw">return</span> <span class="dv">1</span>;
  }
  printf(<span class="st">&quot;2 * %s = %d</span><span class="ch">\n</span><span class="st">&quot;</span>, string, <span class="dv">2</span> * number);

  <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre>
<p>This gives us:</p>
<pre><code>$ make
gcc -std=c99 -Wall parse.c -o parse.exe
$ ./parse.exe
2 * 123 = 246</code></pre>
<p>So the way that this works is that we give two strings to <code>sscanf</code>. The first is the string that we want to parse. The second is a <em>format</em> string. The format string is exactly like the format string that we give to <code>printf</code> and contains some characters but also some special codes e.g. <code>&quot;%d&quot;</code>. For <code>printf</code> the <code>&quot;%d&quot;</code> code marks a place where the decimal representation of an integer variable should be inserted. For <code>sscanf</code> the <code>&quot;%d&quot;</code> code marks a part of the string where there is a decimal representation of an integer that we want to extract so that it can be stored in a variable. In the example above we parse the string <code>&quot;123&quot;</code> with the format string <code>&quot;%d&quot;</code> and store the result in <code>number</code>. The <code>&amp;</code> is used in <code>&amp;number</code> to pass the memory <em>address</em> of the variable <code>number</code> to the <code>sscanf</code> function. The function will use that address to modify the variable <code>number</code>.</p>
<p>We can use more complicated format strings. In the example above we could parse a string <code>&quot;stuff: 123&quot;</code> using a format string <code>&quot;stuff: %d&quot;</code> and it would still work. If the format string has more than one <code>%</code> code then the return value from <code>sscanf</code> is the number of items successfully parsed. So we need to check that matches the number of items actually expected. For example we could do</p>
<pre class="sourceCode C"><code class="sourceCode c">    <span class="dt">int</span> return_code = sscanf(<span class="st">&quot;12:34:mm&quot;</span>, <span class="st">&quot;%d:%d:%d&quot;</span>,
                            &amp;hours, &amp;minutes, &amp;seconds);</code></pre>
<p>In this case <code>sscanf</code> will succeed in parsing <code>12</code> into <code>hours</code> and then the <code>':'</code> matches so it will parse <code>34</code> into <code>minutes</code>. Then it expects to be able to parse a decimal string for <code>seconds</code> but finds the letters <code>&quot;mm&quot;</code>. This causes a parse failure. Since 2 items were successfully parsed <code>sscanf</code> returns <code>2</code>. You can check this by printing out the value of <code>return_code</code>.</p>
<p>If we wanted to check that all items were successfully read we could do something like:</p>
<pre class="sourceCode C"><code class="sourceCode c">    <span class="kw">if</span>(sscanf(<span class="st">&quot;12:34:mm&quot;</span>, <span class="st">&quot;%d:%d:%d&quot;</span>,
              &amp;hours, &amp;minutes, &amp;seconds) != <span class="dv">3</span>)
    {
      fprintf(stderr, <span class="st">&quot;Invalid string</span><span class="ch">\n</span><span class="st">&quot;</span>);
      <span class="kw">return</span> <span class="dv">1</span>; <span class="co">// failure</span>
    }</code></pre>
<h2 id="exercise---sscanf"><a href="#TOC">Exercise - sscanf</a></h2>
<p>Play around with <code>sscanf</code>. Make sure that you understand how it works, when it works, and what happens when it fails. Make sure that you always check the value it returns (and not just in this exercise!).</p>
<h2 id="command-line-arguments"><a href="#TOC">Command line arguments</a></h2>
<p>We've seen <code>argv</code> sitting there as the second argument to our <code>main</code> function for some time now. I haven't explained how to do this yet but <code>argv</code> is an <em>array of strings</em>. Since each string is an array of type <code>char</code>, <code>argv</code> is an array of arrays of type <code>char</code>. I won't talk about how to create such an array but know that <code>argv[0]</code> is a string (array of <code>char</code>) and so is <code>argv[1]</code> etc. The size of the <code>argv</code> array is given by <code>argc</code>. So what are the strings given in <code>argv</code>? They are the command line arguments given to the program. Every program that you've used <code>make</code>, <code>gcc</code>, <code>ls</code>, etc. takes command line arguments and they do this by inspecting the value of <code>argv</code>. Here's a short program that shows how to access the strings in <code>argv</code>:</p>
<pre class="sourceCode C"><code class="sourceCode c"><span class="co">/* args.c */</span>

<span class="ot">#include &lt;stdio.h&gt;</span>

<span class="dt">int</span> main(<span class="dt">int</span> argc, <span class="dt">char</span> *argv[])
{
  printf(<span class="st">&quot;You entered %d arguments</span><span class="ch">\n</span><span class="st">&quot;</span>, argc);
  <span class="kw">for</span>(<span class="dt">int</span> i=<span class="dv">0</span>; i&lt;argc; i++)
  {
    printf(<span class="st">&quot;argv[%d] is %s</span><span class="ch">\n</span><span class="st">&quot;</span>, i, argv[i]);
  }
  <span class="kw">return</span> <span class="dv">0</span>;
}</code></pre>
<p>We can run this to get:</p>
<pre><code>$ make
gcc -std=c99 -Wall args.c -o args.exe
$ ./args.exe 
You entered 1 arguments
argv[0] is ./args.exe
$ ./args.exe foo bar baz
You entered 4 arguments
argv[0] is ./args.exe
argv[1] is foo
argv[2] is bar
argv[3] is baz</code></pre>
<p>Now look carefully at that. We can see that the program prints out different things depending on the arguments typed on the command line in the shell when running the program. This is exactly what we want our programs to be able to do so that we don't have to recompile them all the time just to change some numbers or something.</p>
<h2 id="exercise"><a href="#TOC">Exercise</a></h2>
<p>Extend the cubic integer root-finder program from <a href="exercises2.html#cubic-solver">last week</a>. Your program should now take its input from the command line e.g.:</p>
<pre><code>$ ./findroots.exe 1 -4 -7 10
Roots of x^3 - 4x^2 - 7x + 10:
-2 1 5</code></pre>
<p>Bonus points: can you make this work for a polynomial of any order?</p>
    </div>
  </body>
</html>
